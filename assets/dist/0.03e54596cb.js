(self.webpackChunkvwww=self.webpackChunkvwww||[]).push([[0],{346:()=>{var JSON,c,maps;"undefined"==typeof _pio&&(_pio={}),_pio.channel=function(){},_pio.channel.prototype.call=function(e,t,n,o,r){var i="undefined"!=typeof PLAYERIO_API_HOST?PLAYERIO_API_HOST:(PlayerIO.useSecureApiRequests?"https":"http")+"://api.playerio.com/json/",a=new XMLHttpRequest;"withCredentials"in a?a.open("post",i,!0):"undefined"!=typeof XDomainRequest?(a=new XDomainRequest).open("post",i):a=new _pio.flashWebRequest("post",i);var s=new Error;null!=a?(a.send("["+e+"|"+(this.token||"")+"]"+JSON.stringify(t)),a.onload=function(){var e=null;try{var t=a.response||a.responseText;if("["==t[0]){var i=t.indexOf("]");this.token=t.substring(1,i),t=t.substring(i+1)}e=JSON.parse(t)}catch(e){return void _pio.handleError(s,o,PlayerIOErrorCode.GeneralError,"Error decoding response from webservice: "+e)}if(void 0===e.errorcode&&void 0===e.message){var c=e;if(r)try{c=r(e)}catch(e){_pio.handleError(s,o,PlayerIOErrorCode.GeneralError,e.message)}n&&n(c)}else _pio.handleError(s,o,e.errorcode,e.message)},a.onerror=function(e){_pio.handleError(s,o,PlayerIOErrorCode.GeneralError,"Error talking to webservice: "+JSON.stringify(e))}):_pio.handleError(s,o,PlayerIOErrorCode.GeneralError,"Need to implement flash calling")},_pio.runCallback=function(e,t,n){try{e&&e(t)}catch(e){var o="Unhandled error in callback: "+e.message;o+="\nStack:\n",o+=e.stack||e.stacktrace||e.StackTrace,n&&(o+="\nCallsite stack:\n",o+=n.stack||n.stacktrace||n.StackTrace),console.log(o)}},_pio.handleError=function(e,t,n,o){var r=_pio.error(n,o);e&&(e.stack&&(r.stack=e.stack),e.stacktrace&&(r.stacktrace=e.stacktrace),e.StackTrace&&(r.StackTrace=e.StackTrace)),t?_pio.runCallback(t,r,e):"undefined"!=typeof console?console.log("No error callback specified for: "+r.code+": "+r.message+"\n"+(r.stack||r.stacktrace||r.StackTrace)):alert("No error callback specified for: "+r.code+": "+r.message+"\n"+(r.stack||r.stacktrace||r.StackTrace))},_pio.error=function(e,t){if(1==arguments.length&&(t=e,e=PlayerIOErrorCode.GeneralError),"number"==typeof e&&(e=PlayerIOErrorCode.codes[e]),"string"!=typeof e)throw console.log(e,t,(new Error).stack),"Code must be a string!";var n=new Error;return new PlayerIOError(e,t,n.stack||n.stacktrace||n.StackTrace)},_pio.debugLog=function(e){"undefined"!=typeof console&&console.log(e)},_pio.convertToKVArray=function(e){var t=[];if(e)for(var n in e)t.push({key:""+n,value:""+e[n]});return t},_pio.convertFromKVArray=function(e){var t={};if(e&&e.length)for(var n in e)t[e[n].key]=e[n].value;return t},_pio.convertToSegmentArray=function(e){var t=[];if(e)for(var n in e)t.push(n+":"+e[n]);return t},PlayerIO={useSecureApiRequests:!1,authenticate:function(e,t,n,o,r,i){if("auto"==n.publishingnetworklogin)return void 0===window.PublishingNetwork?void i(new PlayerIOError(PlayerIOErrorCode.GeneralError,"Could not find the PublishingNetwork object on the current page. Did you include the PublishingNetwork.js script?")):void PublishingNetwork.dialog("login",{gameId:e,connectionId:t,__use_usertoken__:!0},(function(n){n.error?i(new PlayerIOError(PlayerIOErrorCode.GeneralError,n.error)):void 0===n.userToken?i(new PlayerIOError(PlayerIOErrorCode.GeneralError,"Missing userToken value in result, but no error message given.")):PlayerIO.authenticate(e,t,{userToken:n.userToken},o,r,i)}));var a=new _pio.channel;a.authenticate(e,t,_pio.convertToKVArray(n),_pio.convertToSegmentArray(o),"javascript",_pio.convertToKVArray({}),null,r,i,(function(t){return a.token=t.token,new _pio.client(a,e,t.gamefsredirectmap,t.userid)}))},quickConnect:null,gameFS:function(e){return new _pio.gameFS(e)}},JSON||(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,(function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+e+'"'}function str(e,t){var n,o,r,i,a,s=gap,c=t[e];switch(c&&"object"==typeof c&&"function"==typeof c.toJSON&&(c=c.toJSON(e)),"function"==typeof rep&&(c=rep.call(t,e,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(c)){for(i=c.length,n=0;n<i;n+=1)a[n]=str(n,c)||"null";return r=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+s+"]":"["+a.join(",")+"]",gap=s,r}if(rep&&"object"==typeof rep)for(i=rep.length,n=0;n<i;n+=1)"string"==typeof rep[n]&&(r=str(o=rep[n],c))&&a.push(quote(o)+(gap?": ":":")+r);else for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(r=str(o,c))&&a.push(quote(o)+(gap?": ":":")+r);return r=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+s+"}":"{"+a.join(",")+"}",gap=s,r}}"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var o;if(gap="",indent="","number"==typeof n)for(o=0;o<n;o+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){var j;function walk(e,t){var n,o,r=e[t];if(r&&"object"==typeof r)for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(void 0!==(o=walk(r,n))?r[n]=o:delete r[n]);return reviver.call(e,t,r)}if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,(function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(){var e={},t=0;__pio_flashfallback_callback__=function(){var t=e[arguments[0]];if(t){for(var n=[],o=1;o!=arguments.length;o++)n[o-1]=arguments[o];t.apply(null,n)}},_pio.flashWebRequest=function(n,o){var r=this;this.response=null,this.onload=function(){},this.onerror=function(){},this.send=function(a){i((function(i){if(null==i)r.onerror("Browser does not support Cross-Origin (CORS) webrequest or Flash as a fallback method");else{var s="cb"+t++;e[s]=function(t,n){delete e[s],t?(r.response=n,r.onload()):r.onerror(n)},i.webrequest(s,n,o,a)}}))}},_pio.flashSocketConnection=function(n,o,r,a,s){var c="cb"+t++,l=this,u=new _pio.messageSerializer,f=!1,h=!1,p=setTimeout((function(){f||(f=!0,r(!1,"Connect attempt timed out"))}),o);this.disconnect=function(){console.log("... this shouldn't happen")},this.sendMessage=function(e){console.log("... send msg. this shouldn't happen")},i((function(t){null==t?(f=!0,r(!1,"Browser does not support WebSocket connections and the Flash fallback failed.")):(e[c]=function(e,n){switch(e){case"onopen":f||(clearTimeout(p),f=!0,h=!0,t.socketSend(c,[0]),r(h));break;case"onclose":case"onerror":l.disconnect();break;case"onmessage":s(u.deserializeMessage(n,0,n.length))}},l.disconnect=function(){if(h){h=!1,a();try{t.socketClose(c)}catch(e){_pio.debugLog(e)}}},l.sendMessage=function(e){var n=u.serializeMessage(e);t.socketSend(c,n)},t.socketConnection(c,n))}))},_pio.isFlashFallbackEnabled=function(e){i((function(t){e(null!=t)}))};var n=null,o=!1,r=null;function i(e){if(null!=n)e(n);else if(o)e(null);else if(null==r){r=[e];var t=setInterval((function(){var e=function(){var e="";e+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="10" height="10" style="$style$" id="$id$">',e+='\t<param name="movie" value="$src$" />',e+='\t<param name="allowNetworking" value="all" />',e+='\t<param name="allowScriptAccess" value="always" />',e+="\t\x3c!--[if !IE]>--\x3e",e+='\t<object type="application/x-shockwave-flash" data="$src$" width="10" height="10" style="$style$">',e+='\t\t<param name="allowNetworking" value="all" />',e+='\t\t<param name="allowScriptAccess" value="always" />',e+="\t</object>",e+="\t\x3c!--<![endif]--\x3e",e=(e=(e=(e+="</object>").replace(/\$id\$/gi,"__pio_flashfallback__")).replace(/\$src\$/gi,"http://192.168.30.154/html5client/FlashFallback/bin-debug/FlashFallback.swf")).replace(/\$style\$/gi,"width:10px;height:10px");var t=document.getElementById("containerId");if(!t){var n=document.createElement("div");n.setAttribute("id",t),n.setAttribute("style","position:absolute;top:-20px;left:-20px"),n.innerHTML=e;try{document.body.appendChild(n)}catch(e){}}var o=function(e){for(var t=document.getElementsByTagName(e),n=0;n!=t.length;n++)if(t[n].ping&&"pong"==t[n].ping())return t[n]};return o("embed")||o("object")}();null!=e&&i(e)}),50);setTimeout((function(){null==n&&i(null)}),3e4);var i=function(e){n=e,o=null==e,clearInterval(t);for(var i=0;i!=r.length;i++)r[i](e)}}else r.push(e)}}(),c=_pio.channel.prototype,c.connect=function(e,t,n,o,r,i,a,s,c,l,u){this.call(10,{gameid:e,connectionid:t,userid:n,auth:o,partnerid:r,playerinsightsegments:i,clientapi:a,clientinfo:s},c,l,u)},_pio.ApiSecurityRule={RespectClientSetting:0,UseHttp:1,UseHttps:2},c.authenticate=function(e,t,n,o,r,i,a,s,c,l){this.call(13,{gameid:e,connectionid:t,authenticationarguments:n,playerinsightsegments:o,clientapi:r,clientinfo:i,playcodes:a},s,c,l)},c.createRoom=function(e,t,n,o,r,i,a,s){this.call(21,{roomid:e,roomtype:t,visible:n,roomdata:o,isdevroom:r},i,a,s)},c.joinRoom=function(e,t,n,o,r,i,a){this.call(24,{roomid:e,joindata:t,isdevroom:n,serverdomainnameneeded:o},r,i,a)},c.createJoinRoom=function(e,t,n,o,r,i,a,s,c,l){this.call(27,{roomid:e,roomtype:t,visible:n,roomdata:o,joindata:r,isdevroom:i,serverdomainnameneeded:a},s,c,l)},c.listRooms=function(e,t,n,o,r,i,a,s){this.call(30,{roomtype:e,searchcriteria:t,resultlimit:n,resultoffset:o,onlydevrooms:r},i,a,s)},c.userLeftRoom=function(e,t,n,o,r,i){this.call(40,{extendedroomid:e,newplayercount:t,closed:n},o,r,i)},c.writeError=function(e,t,n,o,r,i,a,s){this.call(50,{source:e,error:t,details:n,stacktrace:o,extradata:r},i,a,s)},c.updateRoom=function(e,t,n,o,r,i){this.call(53,{extendedroomid:e,visible:t,roomdata:n},o,r,i)},_pio.ValueType={String:0,Int:1,UInt:2,Long:3,Bool:4,Float:5,Double:6,ByteArray:7,DateTime:8,Array:9,Obj:10},c.createObjects=function(e,t,n,o,r){this.call(82,{objects:e,loadexisting:t},n,o,r)},c.loadObjects=function(e,t,n,o){this.call(85,{objectids:e},t,n,o)},_pio.LockType={NoLocks:0,LockIndividual:1,LockAll:2},c.saveObjectChanges=function(e,t,n,o,r,i){this.call(88,{locktype:e,changesets:t,createifmissing:n},o,r,i)},c.deleteObjects=function(e,t,n,o){this.call(91,{objectids:e},t,n,o)},c.loadMatchingObjects=function(e,t,n,o,r,i,a){this.call(94,{table:e,index:t,indexvalue:n,limit:o},r,i,a)},c.loadIndexRange=function(e,t,n,o,r,i,a,s){this.call(97,{table:e,index:t,startindexvalue:n,stopindexvalue:o,limit:r},i,a,s)},c.deleteIndexRange=function(e,t,n,o,r,i,a){this.call(100,{table:e,index:t,startindexvalue:n,stopindexvalue:o},r,i,a)},c.loadMyPlayerObject=function(e,t,n){this.call(103,{},e,t,n)},c.payVaultReadHistory=function(e,t,n,o,r,i){this.call(160,{page:e,pagesize:t,targetuserid:n},o,r,i)},c.payVaultRefresh=function(e,t,n,o,r){this.call(163,{lastversion:e,targetuserid:t},n,o,r)},c.payVaultConsume=function(e,t,n,o,r){this.call(166,{ids:e,targetuserid:t},n,o,r)},c.payVaultCredit=function(e,t,n,o,r,i){this.call(169,{amount:e,reason:t,targetuserid:n},o,r,i)},c.payVaultDebit=function(e,t,n,o,r,i){this.call(172,{amount:e,reason:t,targetuserid:n},o,r,i)},c.payVaultBuy=function(e,t,n,o,r,i){this.call(175,{items:e,storeitems:t,targetuserid:n},o,r,i)},c.payVaultGive=function(e,t,n,o,r){this.call(178,{items:e,targetuserid:t},n,o,r)},c.payVaultPaymentInfo=function(e,t,n,o,r,i){this.call(181,{provider:e,purchasearguments:t,items:n},o,r,i)},c.payVaultUsePaymentInfo=function(e,t,n,o,r){this.call(184,{provider:e,providerarguments:t},n,o,r)},c.partnerPayTrigger=function(e,t,n,o,r){this.call(200,{key:e,count:t},n,o,r)},c.partnerPaySetTag=function(e,t,n,o){this.call(203,{partnerid:e},t,n,o)},c.notificationsRefresh=function(e,t,n,o){this.call(213,{lastversion:e},t,n,o)},c.notificationsRegisterEndpoints=function(e,t,n,o,r){this.call(216,{lastversion:e,endpoints:t},n,o,r)},c.notificationsSend=function(e,t,n,o){this.call(219,{notifications:e},t,n,o)},c.notificationsToggleEndpoints=function(e,t,n,o,r,i){this.call(222,{lastversion:e,endpoints:t,enabled:n},o,r,i)},c.notificationsDeleteEndpoints=function(e,t,n,o,r){this.call(225,{lastversion:e,endpoints:t},n,o,r)},c.gameRequestsSend=function(e,t,n,o,r,i){this.call(241,{requesttype:e,requestdata:t,requestrecipients:n},o,r,i)},c.gameRequestsRefresh=function(e,t,n,o){this.call(244,{playcodes:e},t,n,o)},c.gameRequestsDelete=function(e,t,n,o){this.call(247,{requestids:e},t,n,o)},c.achievementsRefresh=function(e,t,n,o){this.call(271,{lastversion:e},t,n,o)},c.achievementsLoad=function(e,t,n,o){this.call(274,{userids:e},t,n,o)},c.achievementsProgressSet=function(e,t,n,o,r){this.call(277,{achievementid:e,progress:t},n,o,r)},c.achievementsProgressAdd=function(e,t,n,o,r){this.call(280,{achievementid:e,progressdelta:t},n,o,r)},c.achievementsProgressMax=function(e,t,n,o,r){this.call(283,{achievementid:e,progress:t},n,o,r)},c.achievementsProgressComplete=function(e,t,n,o){this.call(286,{achievementid:e},t,n,o)},c.playerInsightRefresh=function(e,t,n){this.call(301,{},e,t,n)},c.playerInsightSetSegments=function(e,t,n,o){this.call(304,{segments:e},t,n,o)},c.playerInsightTrackInvitedBy=function(e,t,n,o,r){this.call(307,{invitinguserid:e,invitationchannel:t},n,o,r)},c.playerInsightTrackEvents=function(e,t,n,o){this.call(311,{events:e},t,n,o)},c.playerInsightTrackExternalPayment=function(e,t,n,o,r){this.call(314,{currency:e,amount:t},n,o,r)},c.playerInsightSessionKeepAlive=function(e,t,n){this.call(317,{},e,t,n)},c.playerInsightSessionStop=function(e,t,n){this.call(320,{},e,t,n)},c.oneScoreLoad=function(e,t,n,o){this.call(351,{userids:e},t,n,o)},c.oneScoreSet=function(e,t,n,o){this.call(354,{score:e},t,n,o)},c.oneScoreAdd=function(e,t,n,o){this.call(357,{score:e},t,n,o)},c.oneScoreRefresh=function(e,t,n){this.call(360,{},e,t,n)},c.simpleConnect=function(e,t,n,o,r,i,a,s,c){this.call(400,{gameid:e,usernameoremail:t,password:n,playerinsightsegments:o,clientapi:r,clientinfo:i},a,s,c)},c.simpleRegister=function(e,t,n,o,r,i,a,s,c,l,u,f,h,p){this.call(403,{gameid:e,username:t,password:n,email:o,captchakey:r,captchavalue:i,extradata:a,partnerid:s,playerinsightsegments:c,clientapi:l,clientinfo:u},f,h,p)},c.simpleRecoverPassword=function(e,t,n,o,r){this.call(406,{gameid:e,usernameoremail:t},n,o,r)},c.kongregateConnect=function(e,t,n,o,r,i,a,s,c){this.call(412,{gameid:e,userid:t,gameauthtoken:n,playerinsightsegments:o,clientapi:r,clientinfo:i},a,s,c)},c.simpleGetCaptcha=function(e,t,n,o,r,i){this.call(415,{gameid:e,width:t,height:n},o,r,i)},c.facebookOAuthConnect=function(e,t,n,o,r,i,a,s,c){this.call(418,{gameid:e,accesstoken:t,partnerid:n,playerinsightsegments:o,clientapi:r,clientinfo:i},a,s,c)},c.steamConnect=function(e,t,n,o,r,i,a,s,c){this.call(421,{gameid:e,steamappid:t,steamsessionticket:n,playerinsightsegments:o,clientapi:r,clientinfo:i},a,s,c)},c.simpleUserGetSecureLoginInfo=function(e,t,n){this.call(424,{},e,t,n)},c.leaderboardsGet=function(e,t,n,o,r,i,a,s,c){this.call(431,{group:e,leaderboard:t,index:n,count:o,neighbouruserid:r,filteruserids:i},a,s,c)},c.leaderboardsSet=function(e,t,n,o,r,i){this.call(434,{group:e,leaderboard:t,score:n},o,r,i)},c.leaderboardsCount=function(e,t,n,o,r){this.call(437,{group:e,leaderboard:t},n,o,r)},c.joinCluster=function(e,t,n,o,r,i,a,s,c,l,u,f,h,p,d,g,y){this.call(504,{clusteraccesskey:e,isdevelopmentserver:t,ports:n,machinename:o,version:r,machineid:i,os:a,cpu:s,cpucores:c,cpulogicalcores:l,cpuaddresswidth:u,cpumaxclockspeed:f,rammegabytes:h,ramspeed:p},d,g,y)},c.serverHeartbeat=function(e,t,n,o,r,i,a,s,c,l,u,f,h,p,d,g,y,v,m,b){this.call(510,{serverid:e,appdomains:t,servertypes:n,machinecpu:o,processcpu:r,memoryusage:i,avaliablememory:a,freememory:s,runningrooms:c,usedresources:l,apirequests:u,apirequestserror:f,apirequestsfailed:h,apirequestsexecuting:p,apirequestsqueued:d,apirequeststime:g,serverunixtimeutc:y},v,m,b)},c.getGameAssemblyUrl=function(e,t,n,o,r,i){this.call(513,{clusteraccesskey:e,gamecodeid:t,machineid:n},o,r,i)},c.devServerLogin=function(e,t,n,o,r){this.call(524,{username:e,password:t},n,o,r)},c.webserviceOnlineTest=function(e,t,n){this.call(533,{},e,t,n)},c.getServerInfo=function(e,t,n,o){this.call(540,{machineid:e},t,n,o)},c.socialRefresh=function(e,t,n){this.call(601,{},e,t,n)},c.socialLoadProfiles=function(e,t,n,o){this.call(604,{userids:e},t,n,o)},PlayerIOError=function(e,t,n){if(this.code=e,this.message=t,this.stack=n,!this.stack){var o=new Error;this.stack=o.stack||o.stacktrace||o.StackTrace}this.toString=function(){return"PlayerIOError["+e+"]: "+t}},PlayerIOError.prototype=new Error,PlayerIOErrorCode={UnsupportedMethod:"UnsupportedMethod",GeneralError:"GeneralError",InternalError:"InternalError",AccessDenied:"AccessDenied",InvalidMessageFormat:"InvalidMessageFormat",MissingValue:"MissingValue",GameRequired:"GameRequired",ExternalError:"ExternalError",ArgumentOutOfRange:"ArgumentOutOfRange",GameDisabled:"GameDisabled",UnknownGame:"UnknownGame",UnknownConnection:"UnknownConnection",InvalidAuth:"InvalidAuth",NoServersAvailable:"NoServersAvailable",RoomDataTooLarge:"RoomDataTooLarge",RoomAlreadyExists:"RoomAlreadyExists",UnknownRoomType:"UnknownRoomType",UnknownRoom:"UnknownRoom",MissingRoomId:"MissingRoomId",RoomIsFull:"RoomIsFull",NotASearchColumn:"NotASearchColumn",QuickConnectMethodNotEnabled:"QuickConnectMethodNotEnabled",UnknownUser:"UnknownUser",InvalidPassword:"InvalidPassword",InvalidRegistrationData:"InvalidRegistrationData",InvalidBigDBKey:"InvalidBigDBKey",BigDBObjectTooLarge:"BigDBObjectTooLarge",BigDBObjectDoesNotExist:"BigDBObjectDoesNotExist",UnknownTable:"UnknownTable",UnknownIndex:"UnknownIndex",InvalidIndexValue:"InvalidIndexValue",NotObjectCreator:"NotObjectCreator",KeyAlreadyUsed:"KeyAlreadyUsed",StaleVersion:"StaleVersion",CircularReference:"CircularReference",HeartbeatFailed:"HeartbeatFailed",InvalidGameCode:"InvalidGameCode",VaultNotLoaded:"VaultNotLoaded",UnknownPayVaultProvider:"UnknownPayVaultProvider",DirectPurchaseNotSupportedByProvider:"DirectPurchaseNotSupportedByProvider",BuyingCoinsNotSupportedByProvider:"BuyingCoinsNotSupportedByProvider",NotEnoughCoins:"NotEnoughCoins",ItemNotInVault:"ItemNotInVault",InvalidPurchaseArguments:"InvalidPurchaseArguments",InvalidPayVaultProviderSetup:"InvalidPayVaultProviderSetup",UnknownPartnerPayAction:"UnknownPartnerPayAction",InvalidType:"InvalidType",IndexOutOfBounds:"IndexOutOfBounds",InvalidIdentifier:"InvalidIdentifier",InvalidArgument:"InvalidArgument",LoggedOut:"LoggedOut",InvalidSegment:"InvalidSegment",GameRequestsNotLoaded:"GameRequestsNotLoaded",AchievementsNotLoaded:"AchievementsNotLoaded",UnknownAchievement:"UnknownAchievement",NotificationsNotLoaded:"NotificationsNotLoaded",InvalidNotificationsEndpoint:"InvalidNotificationsEndpoint",NetworkIssue:"NetworkIssue",OneScoreNotLoaded:"OneScoreNotLoaded",PublishingNetworkNotAvailable:"PublishingNetworkNotAvailable",PublishingNetworkNotLoaded:"PublishingNetworkNotLoaded",DialogClosed:"DialogClosed",AdTrackCheckCookie:"AdTrackCheckCookie",codes:{0:"UnsupportedMethod",1:"GeneralError",2:"InternalError",3:"AccessDenied",4:"InvalidMessageFormat",5:"MissingValue",6:"GameRequired",7:"ExternalError",8:"ArgumentOutOfRange",9:"GameDisabled",10:"UnknownGame",11:"UnknownConnection",12:"InvalidAuth",13:"NoServersAvailable",14:"RoomDataTooLarge",15:"RoomAlreadyExists",16:"UnknownRoomType",17:"UnknownRoom",18:"MissingRoomId",19:"RoomIsFull",20:"NotASearchColumn",21:"QuickConnectMethodNotEnabled",22:"UnknownUser",23:"InvalidPassword",24:"InvalidRegistrationData",25:"InvalidBigDBKey",26:"BigDBObjectTooLarge",27:"BigDBObjectDoesNotExist",28:"UnknownTable",29:"UnknownIndex",30:"InvalidIndexValue",31:"NotObjectCreator",32:"KeyAlreadyUsed",33:"StaleVersion",34:"CircularReference",40:"HeartbeatFailed",41:"InvalidGameCode",50:"VaultNotLoaded",51:"UnknownPayVaultProvider",52:"DirectPurchaseNotSupportedByProvider",54:"BuyingCoinsNotSupportedByProvider",55:"NotEnoughCoins",56:"ItemNotInVault",57:"InvalidPurchaseArguments",58:"InvalidPayVaultProviderSetup",70:"UnknownPartnerPayAction",80:"InvalidType",81:"IndexOutOfBounds",82:"InvalidIdentifier",83:"InvalidArgument",84:"LoggedOut",90:"InvalidSegment",100:"GameRequestsNotLoaded",110:"AchievementsNotLoaded",111:"UnknownAchievement",120:"NotificationsNotLoaded",121:"InvalidNotificationsEndpoint",130:"NetworkIssue",131:"OneScoreNotLoaded",200:"PublishingNetworkNotAvailable",201:"PublishingNetworkNotLoaded",301:"DialogClosed",302:"AdTrackCheckCookie"}},_pio.client=function(e,t,n,o){this.connectUserId=o,this.gameId=t,this.gameFS=new _pio.gameFS(t,n),this.errorLog=new _pio.errorLog(e),this.payVault=new _pio.payVault(e),this.bigDB=new _pio.bigDB(e),this.multiplayer=new _pio.multiplayer(e),this.gameRequests=new _pio.gameRequests(e),this.achievements=new _pio.achievements(e),this.playerInsight=new _pio.playerInsight(e),this.oneScore=new _pio.oneScore(e),this.leaderboards=new _pio.leaderboards(e,this.connectUserId),this.notifications=new _pio.notifications(e),this.publishingNetwork=new _pio.publishingNetwork(e,this.connectUserId)},maps={},_pio.gameFS=function(e,t){if("string"==typeof t&&t.length>0){var n=(t||"").split("|");if(n.length>=1)for(var o=maps[e.toLowerCase()]={},r=0;r!=n.length;r++){var i=n[r];"alltoredirect"==i||"cdnmap"==i?o.baseUrl=n[r+1]:"alltoredirectsecure"==i||"cdnmapsecure"==i?o.secureBaseUrl=n[r+1]:o["."+i]=n[r+1]}}this.getUrl=function(t,n){if("/"==!t[0])throw _pio.error("The path given to getUrl must start with a slash, like: '/myfile.swf' or '/folder/file.jpg'");var o=maps[e];return o?(n?o.secureBaseUrl:o.baseUrl)+(o["."+t]||t):(n?"https":"http")+"://r.playerio.com/r/"+e+t}},_pio.gameRequests=function(e){var t=[];this.waitingRequests="[ERROR: You tried to access gameRequests.waitingRequests before loading waiting requests. You have to call the refresh method first.]";var n=this;function o(e){if(null==e||0==e.length)return[];for(var t=[],n=0;n!=e.length;n++){var o=e[n];t.push(new _pio.gameRequest(o.id,o.type,o.senderuserid,o.created,o.data))}return t}this.send=function(t,n,o,r,i){e.gameRequestsSend(t,_pio.convertToKVArray(n),o,r,i,(function(e){}))},this.refresh=function(r,i){e.gameRequestsRefresh(t,r,i,(function(e){n._playCodes=e.newplaycodes,n.waitingRequests=o(e.requests),e.morerequestswaiting}))},this.delete=function(t,r,i){if("object"==typeof t||t.length){for(var a=[],s=0;s!=t.length;s++){var c=t[s].id;if(!c)return l=_pio.error("No GameRequest id found on item#"+s+". You have to use requests from the gameRequests.waitingRequests array. For instance: client.gameRequests.delete(client.gameRequests.waitingRequests, ...)"),void _pio.handleError(l,i,l.code,l.message);a.push(c)}e.gameRequestsDelete(a,r,i,(function(e){n.waitingRequests=o(e.requests),e.morerequestswaiting}))}else{var l=_pio.error("The first argument to delete should be an array: client.gameRequests.delete([requests], ...)");_pio.handleError(l,i,l.code,l.message)}}},_pio.gameRequest=function(e,t,n,o,r){this.id=e,this.type=t,this.senderUserId=n,this.created=new Date(o),this.data=_pio.convertFromKVArray(r)},_pio.errorLog=function(e){this.writeError=function(t,n,o,r){e.writeError("Javascript",t,n,o,_pio.convertToKVArray(r))}},_pio.quickConnect=function(){this.simpleGetCaptcha=function(e,t,n,o,r){(new _pio.channel).simpleGetCaptcha(e,t,n,o,r,(function(e){return new _pio.simpleGetCaptchaOutput(e.captchakey,e.captchaimageurl)}))},this.simpleRecoverPassword=function(e,t,n,o){(new _pio.channel).simpleRecoverPassword(e,t,n,o,(function(e){}))}},_pio.simpleGetCaptchaOutput=function(e,t){this.captchaKey=e,this.captchaImageUrl=t},PlayerIO.quickConnect=new _pio.quickConnect,_pio.payVault=function(e){var t=null;this.coins="[ERROR: you tried to access payVault.coins before the vault was loaded. You have to refresh the vault before the .coins property is set to the right value]",this.items="[ERROR: you tried to access payVault.items before the vault was loaded. You have to refresh the vault before the .items property is set to the right value]",this.has=function(e){if(null==t)throw new PlayerIOError(PlayerIOErrorCode.VaultNotLoaded,"Cannot access items before vault has been loaded. Please refresh the vault first");for(var n=0;n!=this.items.length;n++)if(this.items[n].itemKey==e)return!0;return!1},this.first=function(e){if(null==t)throw new PlayerIOError(PlayerIOErrorCode.VaultNotLoaded,"Cannot access items before vault has been loaded. Please refresh the vault first");for(var n=0;n!=this.items.length;n++)if(this.items[n].itemKey==e)return this.items[n];return null},this.count=function(e){if(null==t)throw new PlayerIOError(PlayerIOErrorCode.VaultNotLoaded,"Cannot access items before vault has been loaded. Please refresh the vault first");for(var n=0,o=0;o!=this.items.length;o++)this.items[o].itemKey==e&&n++;return n},this.refresh=function(n,r){e.payVaultRefresh(t,null,n,r,(function(e){o(e.vaultcontents)}))},this.readHistory=function(t,n,o,r){e.payVaultReadHistory(t,n,null,o,r,(function(e){for(var t=[],n=0;n!=e.entries.length;n++){var o=e.entries[n];t.push(new _pio.payVaultHistoryEntry(o.type,o.amount,o.timestamp,o.itemkeys||[],o.reason,o.providertransactionid,o.providerprice))}return t}))},this.credit=function(t,n,r,i){e.payVaultCredit(t,n,null,r,i,(function(e){o(e.vaultcontents)}))},this.debit=function(t,n,r,i){e.payVaultDebit(t,n,null,r,i,(function(e){o(e.vaultcontents)}))},this.consume=function(t,n,r){if("object"==typeof t||t.length){for(var i=[],a=0;a!=t.length;a++){var s=t[a].id;if(!s)return c=_pio.error("No PayVault item id found on item#"+a+". You have to use items from the payVault.items array. For instance: client.payVault.consume([client.payVault.first('sportscar')], ...)"),void _pio.handleError(c,r,c.code,c.message);i.push(s)}e.payVaultConsume(i,null,n,r,(function(e){o(e.vaultcontents)}))}else{var c=_pio.error("The first argument to consume should be an array: client.payVault.consume([item], ...)");_pio.handleError(c,r,c.code,c.message)}},this.buy=function(t,n,r,i){e.payVaultBuy(_pio.convertBuyItems(t),n,null,r,i,(function(e){o(e.vaultcontents)}))},this.give=function(t,n,r){e.payVaultGive(_pio.convertBuyItems(t),null,n,r,(function(e){o(e.vaultcontents)}))},this.getBuyCoinsInfo=function(t,n,o,r){e.payVaultPaymentInfo(t,_pio.convertToKVArray(n),null,o,r,(function(e){return _pio.convertFromKVArray(e.providerarguments)}))},this.getBuyDirectInfo=function(t,n,o,r,i){e.payVaultPaymentInfo(t,_pio.convertToKVArray(n),_pio.convertBuyItems(o),r,i,(function(e){return _pio.convertFromKVArray(e.providerarguments)}))};var n=this;function o(e){if(null!=e&&(t=e.version,n.coins=e.coins||0,n.items=[],e.items&&e.items.length))for(var o=0;o!=e.items.length;o++){var r=e.items[o],i=n.items[o]=new _pio.vaultItem(r.id,r.itemkey,(new Date).setTime(r.purchasedate));_pio.bigDBDeserialize(r.properties,i,!0)}}},_pio.convertBuyItems=function(e){if(null==e)return[];for(var t=[],n=0;n!=e.length;n++){var o=e[n].itemkey;if(!o)throw _pio.error("You have to specify an itemkey for the payvault item. Example:  {itemkey:'car'}");t.push({itemkey:o,payload:_pio.compareForChanges({itemkey:o},e[n],!0,!0)})}return t},_pio.vaultItem=function(e,t,n){this.id=e,this.itemKey=t,this.purchaseDate=n},_pio.payVaultHistoryEntry=function(e,t,n,o,r,i,a){this.type=e,this.amount=t,this.timestamp=(new Date).setTime(n),this.itemKeys=o,this.reason=r,this.providerTransactionId=i,this.providerPrice=a},_pio.bigDB=function(e){var t=this,n=[];function o(){for(var e=0;e<n.length;e++){var t=n[e],o=!0;for(var r in t.objects)if(t.objects[r]._internal_("get-is-saving")){o=!1;break}if(o){for(var r in t.objects)for(var i=e+1;i<n.length;i++){futureSave=n[i];for(var a=0;a<futureSave.objects.length;a++)futureSave.objects[a]==t.objects[r]&&futureSave.fullOverwrite==t.fullOverwrite&&futureSave.useOptimisticLock==t.useOptimisticLock&&(t.changesets[r]=futureSave.changesets[a],t.futureSaves.push(futureSave))}n.splice(e,1),e--,t.execute()}}}function r(e,t){null==e?e=[]:e instanceof Array||(e=[e]),null!=t&&(e=e.concat([t]));for(var n=[],o=0;o!=e.length;o++){var r=e[o];switch(typeof r){case"boolean":n.push({valuetype:_pio.ValueType.Bool,bool:r});break;case"string":n.push({valuetype:_pio.ValueType.String,string:r});break;case"number":r%1!=0?n.push({valuetype:_pio.ValueType.Double,double:r}):r>-2147483648&&r<2147483647?n.push({valuetype:_pio.ValueType.Int,int:r}):r>0&&r<4294967295?n.push({valuetype:_pio.ValueType.UInt,uint:r}):n.push({valuetype:_pio.ValueType.Long,long:r});break;case"object":if(!r.getTime||!r.getMilliseconds)throw new Error("Don't know how to serialize type '"+typeof r+"' for BigDB");n.push({valuetype:_pio.ValueType.DateTime,datetime:r.getTime()});break;default:throw new Error("Don't know how to serialize type '"+typeof r+"' for BigDB")}}return n}this.createObject=function(n,o,r,i,a){var s=_pio.compareForChanges({},r||{},!0,!0);e.createObjects([{key:o,table:n,properties:s}],!1,i,a,(function(e){if(1==e.objects.length)return new _pio.databaseobject(t,n,e.objects[0].key,e.objects[0].version,!1,s);throw new PlayerIOError(PlayerIOErrorCode.GeneralError,"Error creating object")}))},this.loadMyPlayerObject=function(n,o){e.loadMyPlayerObject(n,o,(function(e){return new _pio.databaseobject(t,"PlayerObjects",e.playerobject.key,e.playerobject.version,!0,e.playerobject.properties)}))},this.load=function(n,o,r,i){e.loadObjects([{table:n,keys:[o]}],r,i,(function(e){if(1==e.objects.length)return null==e.objects[0]?null:new _pio.databaseobject(t,n,e.objects[0].key,e.objects[0].version,!1,e.objects[0].properties);throw new PlayerIOError(PlayerIOErrorCode.GeneralError,"Error loading object")}))},this.loadKeys=function(n,o,r,i){e.loadObjects([{table:n,keys:o}],r,i,(function(e){for(var o=[],r=0;r!=e.objects.length;r++){var i=e.objects[r];o[r]=null==i?null:new _pio.databaseobject(t,n,i.key,i.version,!1,i.properties)}return o}))},this.loadOrCreate=function(n,o,r,i){e.createObjects([{key:o,table:n,properties:[]}],!0,r,i,(function(e){if(1==e.objects.length)return new _pio.databaseobject(t,n,e.objects[0].key,e.objects[0].version,!1,e.objects[0].properties);throw new PlayerIOError(PlayerIOErrorCode.GeneralError,"Error creating object")}))},this.deleteKeys=function(t,n,o,r){e.deleteObjects([{table:t,keys:n}],o,r,(function(e){return null}))},this.loadKeysOrCreate=function(n,o,r,i){for(var a=[],s=0;s!=o.length;s++)a.push({key:o[s],table:n,properties:[]});e.createObjects(a,!0,r,i,(function(e){for(var o=[],r=0;r!=e.objects.length;r++){var i=e.objects[r];o[r]=new _pio.databaseobject(t,n,i.key,i.version,!1,i.properties)}return o}))},this.loadSingle=function(n,o,i,a,s){e.loadMatchingObjects(n,o,r(i),1,a,s,(function(e){return 0==e.objects.length?null:new _pio.databaseobject(t,n,e.objects[0].key,e.objects[0].version,!1,e.objects[0].properties)}))},this.loadRange=function(n,o,i,a,s,c,l,u){e.loadIndexRange(n,o,r(i,a),r(i,s),c,l,u,(function(e){for(var o=[],r=0;r!=e.objects.length;r++){var i=e.objects[r];o[r]=null==i?null:new _pio.databaseobject(t,n,i.key,i.version,!1,i.properties)}return o}))},this.deleteRange=function(t,n,o,i,a,s,c){e.deleteIndexRange(t,n,r(o,i),r(o,a),s,c,(function(){}))},this.saveChanges=function(t,r,i,a,s){var c=1==arguments[5],l=[];for(var u in i){var f=i[u];if(!(f.existsInDatabase&&f.key&&f.table&&f._internal_&&f.save)){var h=_pio.error("You can only save database objects that exist in the database");return void _pio.handleError(h,s,h.code,h.message)}var p=_pio.compareForChanges(r?{}:f._internal_("get-dbCurrent"),f,!0,!0);(r||p.length>0)&&l.push({key:f._internal_("get-key"),table:f._internal_("get-table"),fulloverwrite:r,onlyifversion:t?f._internal_("get-version"):null,changes:p})}n.push({objects:i,changesets:l,fullOverwrite:r,useOptimisticLock:t,futureSaves:[],setIsSavingOnAll:function(e){for(var t=0;t!=this.objects.length;t++)this.objects[t]._internal_("set-is-saving",e)},done:function(){this.setIsSavingOnAll(!1),o()},execute:function(){var t=this;t.setIsSavingOnAll(!0),t.changesets.length>0?e.saveObjectChanges(_pio.LockType.LockAll,t.changesets,c,a,(function(e){t.done(),_pio.handleError(e,s,e.code,e.message)}),(function(e){for(var n=0;n!=t.objects.length;n++){var o=t.objects[n];o._internal_("set-version",e.versions[n]),o._internal_("change-dbCurrent",t.changesets[n].changes);for(var r=0;r!=t.futureSaves.length;r++)for(var i=t.futureSaves[r],a=0;a<i.objects.length;a++)i.objects[a]==o&&(i.changesets.splice(a,1),i.objects.splice(a,1),a--)}t.done()})):(t.done(),setTimeout(a,1))}}),o()}},_pio.databaseobject=function(e,t,n,o,r,i){var a={},s=!1;_pio.bigDBDeserialize(i,a,!0),this.table=t,this.key=n,this.existsInDatabase=!0,this.save=function(t,n,o,i){e.saveChanges(t,n,[this],o,i,r)},this._internal_=function(e,r){switch(e){case"get-table":return t;case"get-key":return n;case"set-is-saving":s=r;case"get-is-saving":return s;case"get-version":return o;case"set-version":o=r;case"get-dbCurrent":return a;case"change-dbCurrent":_pio.bigDBDeserialize(r,a,!0)}},_pio.bigDBDeserialize(i,this,!0)},_pio.compareForChanges=function(e,t,n,o){var r=[];for(var i in t){var a=t[i],s=e?e[i]:null;switch(i){case"table":if(o)continue;case"key":if(o)continue;case"save":if(o)continue;case"existsInDatabase":if(o)continue;case"_internal_":if(o)continue;case"_circular_reference_finder_":continue}if(null!=a){var c=n?{name:i}:{index:parseInt(i)};switch(typeof a){case"boolean":a!=s&&(c.value={valuetype:_pio.ValueType.Bool,bool:a},r.push(c));break;case"number":a!=s&&(isFinite(a)&&Math.floor(a)===a?c.value=a>=-2147483648&&a<=2147483647?{valuetype:_pio.ValueType.Int,int:a}:a>0&&a<=4294967295?{valuetype:_pio.ValueType.UInt,uint:a}:a>=-0x7ffffffffffffc00&&a<=0x7ffffffffffffc00?{valuetype:_pio.ValueType.Long,long:a}:a>0&&a<=0xfffffffffffff800?{valuetype:_pio.ValueType.ULong,ulong:a}:{valuetype:_pio.ValueType.Double,double:a}:c.value={valuetype:_pio.ValueType.Double,double:a},r.push(c));break;case"string":a!=s&&(c.value={valuetype:_pio.ValueType.String,string:a},r.push(c));break;case"object":if(a.getTime&&a.getMilliseconds)a+""!=s+""&&(c.value={valuetype:_pio.ValueType.DateTime,datetime:a.getTime()},r.push(c));else{if(a._circular_reference_finder_)throw new PlayerIOError(PlayerIOErrorCode.CircularReference,"The object you're trying to save contains a circular reference for "+(n?"a property named":"the array entry")+"): "+i);a._circular_reference_finder_=!0;var l=a instanceof Array;if(l&&a.bytearray){for(var u=new Array(a.length),f=0;f!=u.length;f++){var h=a[f];if(!(h>=0&&h<=255))throw new PlayerIOError(PlayerIOErrorCode.GeneralError,"The bytearray property '"+i+"' was supposed to only contain byte (0-255) values, but contained the value: "+h);u[f]=h}c.value={valuetype:_pio.ValueType.ByteArray,bytearray:u}}else{var p=_pio.compareForChanges(s,a,!l,!1);c.value=l?{valuetype:_pio.ValueType.Array,arrayproperties:p}:{valuetype:_pio.ValueType.Obj,objectproperties:p}}r.push(c),delete a._circular_reference_finder_}break;case"undefined":case"function":break;default:throw new Error("Don't know how to serialize type '"+typeof a+"' for BigDB")}}}for(var i in e)null!=t[i]&&void 0!==t[i]||r.push(n?{name:i}:{index:parseInt(i)});return r},_pio.bigDBDeserialize=function(e,t,n){for(var o in e){var r=e[o],i=n?r.name:r.index||0,a=r.value;if(a)switch(a.valuetype||0){case _pio.ValueType.String:t[i]=a.string||"";break;case _pio.ValueType.Int:t[i]=a.int||0;break;case _pio.ValueType.UInt:t[i]=a.uint||0;break;case _pio.ValueType.Long:t[i]=a.long||0;break;case _pio.ValueType.Bool:t[i]=a.bool||0;break;case _pio.ValueType.Float:t[i]=a.float||0;break;case _pio.ValueType.Double:t[i]=a.double||0;break;case _pio.ValueType.ByteArray:t[i]=a.bytearray,t[i].bytearray=!0;break;case _pio.ValueType.DateTime:t[i]=new Date(a.datetime||0);break;case _pio.ValueType.Array:var s=t[i]instanceof Array?t[i]:[];_pio.bigDBDeserialize(a.arrayproperties,s,!1),t[i]=s;break;case _pio.ValueType.Obj:var c="object"==typeof t[i]?t[i]:{};_pio.bigDBDeserialize(a.objectproperties,c,!0),t[i]=c}else delete t[i]}},function(){_pio.multiplayer=function(e){var t=this;this.developmentServer=null,this.useSecureConnections=!1,this.createRoom=function(n,o,r,i,a,s){e.createRoom(n,o,r,_pio.convertToKVArray(i),null!=t.developmentServer,a,s,(function(e){return e.roomid}))},this.joinRoom=function(n,o,r,i){clearTimeout(setTimeout((function(){r(new _pio.connection)}),1e4));var a=new Error;e.joinRoom(n,_pio.convertToKVArray(o),null!=t.developmentServer,t.useSecureConnections,(function(){}),i,(function(e){return new _pio.connection(a,t.developmentServer,t.useSecureConnections,e.endpoints,e.joinkey,o||{},r,i)}))},this.createJoinRoom=function(n,o,r,i,a,s,c){clearTimeout(setTimeout((function(){s(new _pio.connection)}),1e4));var l=new Error;e.createJoinRoom(n,o,r,_pio.convertToKVArray(i),_pio.convertToKVArray(a),null!=t.developmentServer,t.useSecureConnections,(function(){}),c,(function(e){return new _pio.connection(l,t.developmentServer,t.useSecureConnections,e.endpoints,e.joinkey,a||{},s,c)}))},this.listRooms=function(n,o,r,i,a,s){e.listRooms(n,_pio.convertToKVArray(o),r,i,null!=t.developmentServer,a,s,(function(e){var t=[];if(e.rooms&&e.rooms.length>0)for(var n=0;n!=e.rooms.length;n++){var o=e.rooms[n];t.push(new _pio.roomInfo(o.id,o.roomtype,o.onlineusers,_pio.convertFromKVArray(o.roomdata)))}return t}))}},_pio.websocketConnection=function(e,t,n,o,r,i,a){var s=this,c=!1,l=new _pio.messageSerializer,u=!1,f=null,h=(t?"wss://":"ws://")+n+"/";try{f="undefined"!=typeof MozWebSocket?new MozWebSocket(h):new WebSocket(h)}catch(e){return void r(!1,""+e)}var p=setTimeout((function(){c||(c=!0,r(!1,"Connect attempt timed out"))}),o);f.onopen=function(){c||(clearTimeout(p),c=!0,r(u=!0))},f.onclose=function(e){s.disconnect()},f.onerror=function(e){s.disconnect()},f.onmessage=function(t){if(u)if(e){var n=new FileReader;n.onloadend=function(){for(var e=new Uint8Array(n.result),t=new Array(e.length),o=0;o!=e.length;o++)t[o]=e[o];a(l.deserializeMessage(t,0,t.length))},n.readAsArrayBuffer(t.data)}else{var o=_pio.base64decode(t.data);a(l.deserializeMessage(o,0,o.length))}},this.disconnect=function(){if(u){u=!1,i();try{f.close()}catch(e){_pio.debugLog(e)}}},this.sendMessage=function(t){var n=l.serializeMessage(t);if(e){for(var o=new Uint8Array(n.length),r=0;r<n.length;r++)o[r]=n[r];f.send(o.buffer)}else{var i=_pio.base64encode(n);f.send(i)}}},_pio.connection=function(e,t,n,o,r,i,a,s){var c=this,l=!0,u=[],f={},h=[],p=null,d=/(WebKit|Firefox|Trident)\/([0-9]+)/gi.exec(navigator.userAgent),g=d&&d.length>=3?d[1]:null,y=d&&d.length>=3?parseInt(d[2]):null;function v(h){var d=[];if(t)d.push(t);else for(var g=0;g!=o.length;g++)d.push(o[g].address+":"+o[g].port);function y(e,t){var n=f[e];if(n)for(var o=0;o<n.length;o++)_pio.runCallback(n[o].callback,t,n[o].stackSource)}!function t(){if(d.length>0){var o=d[0];d.splice(0,1);var f=h(n,o,4e3,(function(e,n){if(e){p=f,c.connected=!0;var a=c.createMessage("join");if(a.addString(r),null!=i)for(var s in i)a.addString(s),a.addString(""+i[s]);c.sendMessage(a)}else _pio.debugLog("Unable to connect to endpoint: "+o+'. reason: "'+n+(d.length>0?'". Trying next endpoint.':'". No more endpoints to try.')),t()}),(function(e){c.connected&&(c.connected=!1,setTimeout((function(){for(var e=0;e!=u.length;e++)_pio.runCallback(u[e].callback,c,u[e].stackSource)}),100))}),(function(t){l?"playerio.joinresult"==t.type?(l=!1,t.getBoolean(0)?_pio.runCallback(a,c,null):_pio.handleError(e,s,t.getInt(1),t.getString(2))):_pio.handleError(e,s,PlayerIOErrorCode.GeneralError,"The expected inital messagetype is: playerio.joinresult, received: "+joinResult.getType()):(y(t.type,t),y("*",t))}))}else _pio.handleError(e,s,PlayerIOErrorCode.GeneralError,"Could not establish a socket connection to any of the given endpoints for the room")}()}window.FileReader&&"WebKit"==g&&y>=535||"Firefox"==g&&y>=11||"Trident"==g&&y>=6?v((function(e,t,n,o,r,i){return new _pio.websocketConnection(!0,e,t,n,o,r,i)})):_pio.isFlashFallbackEnabled((function(e){v(e?function(e,t,n,o,r,i){return new _pio.flashSocketConnection(t,n,o,r,i)}:function(e,t,n,o,r,i){return new _pio.websocketConnection(!1,e,t,n,o,r,i)})})),this.connected=!1,this.addDisconnectCallback=function(e){u.push({callback:e,stackSourc:new Error})},this.addMessageCallback=function(e,t){null==e&&(e="*");var n=f[e];n||(f[e]=n=[]),n.push({callback:t,stackSource:new Error})},this.removeDisconnectCallback=function(e){for(var t=0;t<u.length;t++)u[t].callback==e&&(u.splice(t,1),t--)},this.removeMessageCallback=function(e){for(var t in f)for(var n=f[t],o=0;o<n.length;o++)n[o].callback==e&&(n.splice(o,1),o--)},this.createMessage=function(e){for(var t=new _pio.message(e),n=1;n<arguments.length;n++)t.add(arguments[n]);return t},this.send=function(e){var t=this.createMessage.apply(this,arguments);this.sendMessage(t)},this.sendMessage=function(e){c.connected?p.sendMessage(e):h.push(e)},this.disconnect=function(){c.connected&&p.disconnect()}},_pio.message=function(e){var t=this,n=[],o=[];function r(e,r,i,a){if(!e)throw _pio.error("The given value ("+r+") is not "+a);o.push(r),n.push(i),t.length=o.length}function i(e,r){if(e>o.length)throw _pio.error("this message ("+t.type+") only has "+o.length+" entries");if(n[e]==r)return o[e];throw _pio.error("Value at index:"+e+" is a "+a(n[e])+" and not a "+a(r)+" as requested. The value is: "+o[e])}function a(e){return{0:"Integer",1:"Unsigned Integer",2:"Long",3:"Unsigned Long",4:"Double",5:"Float",6:"String",7:"ByteArray",8:"Boolean"}[e]}function s(e){var t="object"==typeof e&&void 0!==e.length;if(t)for(var n=0;n!=e.length;n++)if(e[n]>255||e[n]<0){t=!1;break}return t}this.type=e,this.length=0,this.add=function(){for(var e=0;e<arguments.length;e++){var n=arguments[e];switch(typeof n){case"string":t.addString(n);break;case"boolean":t.addBoolean(n);break;case"number":if(isFinite(n)&&Math.floor(n)===n){if(n>=-2147483648&&n<=2147483647){t.addInt(n);break}if(n>0&&n<=4294967295){t.addUInt(n);break}if(n>=-0x7ffffffffffffc00&&n<=0x7ffffffffffffc00){t.addLong(n);break}if(n>0&&n<=0xfffffffffffff800){t.addULong(n);break}}t.addDouble(n);break;case"object":if(s(n)){this.addByteArray(n);break}default:throw _pio.error("The type of the value ("+n+") cannot be inferred")}}},this.addInt=function(e){r(e>=-2147483648&&e<=2147483647,Math.trunc(e),0,"an integer (32bit)")},this.addUInt=function(e){r(e>=0&&e<=4294967295,Math.trunc(e),1,"an unsigned integer (32bit)")},this.addLong=function(e){r(e>=-0x7ffffffffffffc00&&e<=0x7ffffffffffffc00,Math.trunc(e),2,"a long (64bit)")},this.addULong=function(e){r(e>=0&&e<=0xfffffffffffff800,e,3,"an unsigned long (64bit)")},this.addBoolean=function(e){r(!0,!!e,8,"a boolean value")},this.addFloat=function(e){r(!0,Number(e),5,"a floating point value (32bit)")},this.addDouble=function(e){r(!0,Number(e),4,"a double floating point value (64bit)")},this.addByteArray=function(e){r(s(e),e,7,"a bytearray")},this.addString=function(e){r(!0,e+"",6,"a string")},this.getInt=function(e){return i(e,0)},this.getUInt=function(e){return i(e,1)},this.getLong=function(e){return i(e,2)},this.getULong=function(e){return i(e,3)},this.getBoolean=function(e){return i(e,8)},this.getDouble=function(e){return i(e,4)},this.getFloat=function(e){return i(e,5)},this.getByteArray=function(e){return i(e,7)},this.getString=function(e){return i(e,6)},this.toString=function(){for(var e="msg.Type = "+this.type,t=0;t!=this.length;t++)e+=", msg["+t+"] = "+o[t]+" ("+a(n[t])+")";return e},this._internal_=function(e,t){switch(e){case"get-objects":return o;case"get-types":return n}}},_pio.roomInfo=function(e,t,n,o){this.id=e,this.roomType=t,this.onlineUsers=n,this.roomData=o},_pio.byteWriter=function(){this.bytes=[],this.writeByte=function(e){if(!(e>=0&&e<=255))throw new Error("This is not a byte value: "+e);this.bytes.push(e)},this.writeBytes=function(e){for(var t=0;t!=e.length;t++)this.writeByte(e[t])},this.writeTagWithLength=function(e,t,n){e>63||e<0?this.writeBottomPatternAndBytes(n,_pio.binaryserializer.bytesFromInt(e)):this.writeByte(t|e)},this.writeBottomPatternAndBytes=function(e,t){var n=0;0!=t[0]?n=3:0!=t[1]?n=2:0!=t[2]&&(n=1),this.writeByte(e|n);for(var o=t.length-n-1;o!=t.length;o++)this.writeByte(t[o])},this.writeLongPattern=function(e,t,n){for(var o=0,r=0;7!=r;r++)if(0!=n[r]){o=7-r;break}for(o>3?this.writeByte(t|o-4):this.writeByte(e|o),r=n.length-o-1;r!=n.length;r++)this.writeByte(n[r])}},_pio.messageSerializer=function(){var e=192,t=128;this.serializeMessage=function(n){var o=new _pio.byteWriter;o.length,o.writeTagWithLength(n.length,t,4);var r=_pio.binaryserializer.bytesFromString(n.type);o.writeTagWithLength(r.length,e,12),o.writeBytes(r);for(var i=0;i!=n.length;i++){var a=n._internal_("get-objects")[i];switch(n._internal_("get-types")[i]){case 6:r=_pio.binaryserializer.bytesFromString(a),o.writeTagWithLength(r.length,e,12),o.writeBytes(r);break;case 0:o.writeTagWithLength(a,t,4);break;case 1:o.writeBottomPatternAndBytes(8,_pio.binaryserializer.bytesFromUInt(a));break;case 2:o.writeLongPattern(48,52,_pio.binaryserializer.bytesFromLong(a));break;case 3:o.writeLongPattern(56,60,_pio.binaryserializer.bytesFromULong(a));break;case 7:o.writeTagWithLength(a.length,64,16),o.writeBytes(a);break;case 4:o.writeByte(3),o.writeBytes(_pio.binaryserializer.bytesFromDouble(a));break;case 5:o.writeByte(2);var s=_pio.binaryserializer.bytesFromFloat(a);o.writeBytes(s);break;case 8:o.writeByte(a?1:0)}}return o.bytes},this.deserializeMessage=function(n,o,r){for(var i=o,a=o+r,s=null,c=0;i<a;){var l=0,u=0,f=n[i];i++;var h=192&f;switch(0==h&&0==(h=60&f)&&(h=f),h){case 12:case 16:if(i+(l=1+(3&f))>a)throw new Error("Unexpected: Unfinished message");var p=l;l=_pio.binaryserializer.intFromBytes(n,i,l),i+=p;break;case e:l=63&f;break;case t:u=63&f;break;case 64:l=63&f;break;case 4:case 8:case 48:case 56:l=1+(3&f);break;case 52:case 60:l=5+(3&f);break;case 3:l=8;break;case 2:l=4}if(i+l>a)throw new Error("Unexpected: Unfinished message");switch(h){case 12:case e:null==s?(s=new _pio.message(_pio.binaryserializer.stringFromBytes(n,i,l)),c++):s.addString(_pio.binaryserializer.stringFromBytes(n,i,l));break;case 4:u=_pio.binaryserializer.intFromBytes(n,i,l);case t:0==c?c=u:s.addInt(u);break;case 16:case 64:s.addByteArray(n.slice(i,i+l));break;case 8:s.addUInt(_pio.binaryserializer.uintFromBytes(n,i,l));break;case 48:case 52:s.addLong(_pio.binaryserializer.longFromBytes(n,i,l));break;case 56:case 60:s.addULong(_pio.binaryserializer.ulongFromBytes(n,i,l));break;case 3:s.addDouble(_pio.binaryserializer.doubleFromBytes(n,i,l));break;case 2:s.addFloat(_pio.binaryserializer.floatFromBytes(n,i,l));break;case 1:s.addBoolean(!0);break;case 0:s.addBoolean(!1)}if(i+=l,null!=s&&0==--c)return s}throw new Error("Unexpected: Misaligned message")}},_pio.binaryserializer={pow2:function(e){return e>=0&&e<31?1<<e:this.pow2[e]||(this.pow2[e]=Math.pow(2,e))},_intEncode:function(e,t){var n=new Array(t);if(4==t)n=[e>>>24&255,e>>>16&255,e>>>8&255,255&e];else if(e>=0)n=[(o=Math.floor(e/this.pow2(32)))>>>24&255,o>>>16&255,o>>>8&255,255&o,(r=e-o*this.pow2(32))>>>24&255,r>>>16&255,r>>>8&255,255&r];else{var o,r=e-(o=Math.floor(e/this.pow2(32)))*this.pow2(32);n=[(o+=this.pow2(32))>>>24&255,o>>>16&255,o>>>8&255,255&o,r>>>24&255,r>>>16&255,r>>>8&255,255&r]}return n},_floatEncode:function(e,t,n){var o,r,i=e<0?1:0,a=~(-1<<n-1),s=1-a;e<0&&(e=-e),0===e?(o=0,r=0):isNaN(e)?(o=2*a+1,r=1):e===1/0?(o=2*a+1,r=0):(o=Math.floor(Math.log(e)/Math.LN2))>=s&&o<=a?(r=Math.floor((e*this.pow2(-o)-1)*this.pow2(t)),o+=a):(r=Math.floor(e/this.pow2(s-t)),o=0);for(var c=[];t>=8;)c.push(r%256),r=Math.floor(r/256),t-=8;for(o=o<<t|r,n+=t;n>=8;)c.push(255&o),o>>>=8,n-=8;return c.push(i<<n|o),c.reverse(),c},bytesFromString:function(e){for(var t=[],n=0;n<e.length;n++)if(e.charCodeAt(n)<=127)t.push(e.charCodeAt(n));else for(var o=encodeURIComponent(e.charAt(n)).substr(1).split("%"),r=0;r<o.length;r++)t.push(parseInt(o[r],16));return t},bytesFromInt:function(e){return this._intEncode(e,4)},bytesFromUInt:function(e){return this._intEncode(e,4)},bytesFromLong:function(e){return this._intEncode(e,8)},bytesFromULong:function(e){return this._intEncode(e,8)},bytesFromFloat:function(e){return this._floatEncode(e,23,8)},bytesFromDouble:function(e){return this._floatEncode(e,52,11)},_intDecode:function(e,t,n,o,r){for(var i=t+n-1,a=r&&n==o&&128&e[t],s=0,c=1,l=0;l<n;l++){var u=e[i-l];a&&(c=(u=(255^u)+c)>>8,u&=255),s+=u*this.pow2(8*l)}return a?-s:s},_float32Decode:function(e,t){var n=e.slice(t,t+4).reverse(),o=1-2*(n[3]>>7),r=(n[3]<<1&255|n[2]>>7)-127,i=(127&n[2])<<16|n[1]<<8|n[0];return 128===r?0!==i?NaN:o*(1/0):-127===r?o*i*this.pow2(-149):o*(1+i*this.pow2(-23))*this.pow2(r)},_float64Decode:function(e,t){var n=e.slice(t,t+8).reverse(),o=1-2*(n[7]>>7),r=((n[7]<<1&255)<<3|n[6]>>4)-1023,i=(15&n[6])*this.pow2(48)+n[5]*this.pow2(40)+n[4]*this.pow2(32)+n[3]*this.pow2(24)+n[2]*this.pow2(16)+n[1]*this.pow2(8)+n[0];return 1024===r?0!==i?NaN:o*(1/0):-1023===r?o*i*this.pow2(-1074):o*(1+i*this.pow2(-52))*this.pow2(r)},stringFromBytes:function(e,t,n){for(var o="",r=t;r<t+n;r++)o+=e[r]<=127?37===e[r]?"%25":String.fromCharCode(e[r]):"%"+e[r].toString(16).toUpperCase();return decodeURIComponent(o)},intFromBytes:function(e,t,n){return this._intDecode(e,t,n,4,!0)},uintFromBytes:function(e,t,n){return this._intDecode(e,t,n,4,!1)},longFromBytes:function(e,t,n){return this._intDecode(e,t,n,8,!0)},ulongFromBytes:function(e,t,n){return this._intDecode(e,t,n,8,!1)},floatFromBytes:function(e,t,n){return 4==n?this._float32Decode(e,t):NaN},doubleFromBytes:function(e,t,n){return 8==n?this._float64Decode(e,t):NaN}};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t=[],n=0;n!=e.length;n++)t[e.charCodeAt(n)]=n;_pio.base64encode=function(t){for(var n=[],o=0;o<t.length;o++){var r=t[o],i=++o<=t.length?t[o]:NaN,a=++o<=t.length?t[o]:NaN,s=r>>2,c=(3&r)<<4|i>>4,l=(15&i)<<2|a>>6,u=63&a;isNaN(i)?l=u=64:isNaN(a)&&(u=64),n.push(e.charAt(s)),n.push(e.charAt(c)),n.push(e.charAt(l)),n.push(e.charAt(u))}return n.join("")},_pio.base64decode=function(e){for(var n=[],o=0;o<e.length;o++){var r=t[e.charCodeAt(o)],i=++o<e.length?t[e.charCodeAt(o)]:64,a=++o<e.length?t[e.charCodeAt(o)]:64,s=++o<e.length?t[e.charCodeAt(o)]:64,c=r<<2|i>>4,l=(15&i)<<4|a>>2,u=(3&a)<<6|s;n.push(c),64!=a&&(n.push(l),64!=s&&n.push(u))}return n}}(),_pio.achievements=function(e){var t=null;this.myAchievements="[ERROR: You tried to access achievements.myAchievements before loading them. You have to call the refresh method first.]",this.onCompleteHandlers=[];var n=this;function o(e,t){var o=new _pio.achievement(e.identifier,e.title,e.description,e.imageurl,e.progress,e.progressgoal,e.lastupdated);if("string"!=typeof n.myAchievements)for(var r=0;r<n.myAchievements.length;r++)n.myAchievements[r].id==o.id&&(n.myAchievements[r]=o,n.currentVersion=null);if(t)for(r=0;r<n.onCompleteHandlers.length;r++)(0,n.onCompleteHandlers[r])(o);return o}this.addOnComplete=function(e){if("function"!=typeof e||1!=e.length)throw new PlayerIOError(PlayerIOErrorCode.InvalidArgument,"Expects argument to be a function that takes an achievement as an argument.");n.onCompleteHandlers.push(e)},this.get=function(e){if("string"==typeof n.myAchievements)return null;for(var t=0;t<n.myAchievements.length;t++)if(n.myAchievements[t].id==e)return n.myAchievements[t];return null},this.refresh=function(o,r){e.achievementsRefresh(t,o,r,(function(e){if(t!=e.version)if(t=e.version,null==e.achievements||0==e.achievements.length)n.myAchievements=[];else{for(var o=[],r=0;r<e.achievements.length;r++){var i=e.achievements[r];o.push(new _pio.achievement(i.identifier,i.title,i.description,i.imageurl,i.progress,i.progressgoal,i.lastupdated))}n.myAchievements=o}}))},this.load=function(t,n,o){if("object"==typeof t||requests.length)e.achievementsLoad(t,n,o,(function(e){if(null==e||0==e.length)return{};for(var t={},n=0;n<e.userachievements.length;n++){for(var o=e.userachievements[n],r=[],i=0;i<o.achievements.length;i++){var a=o.achievements[i];r.push(new _pio.achievement(a.identifier,a.title,a.description,a.imageurl,a.progress,a.progressgoal,a.lastupdated))}t[o.userid]=r}return t}));else{var r=_pio.error("The first argument to load should be an array: client.achievements.load(['user1', 'user2', ...], ...)");_pio.handleError(r,o,r.code,r.message)}},this.progressSet=function(t,n,r,i){e.achievementsProgressSet(t,n,r,i,(function(e){return o(e.achievement,e.completednow)}))},this.progressAdd=function(t,n,r,i){e.achievementsProgressAdd(t,n,r,i,(function(e){return o(e.achievement,e.completednow)}))},this.progressMax=function(t,n,r,i){e.achievementsProgressMax(t,n,r,i,(function(e){return o(e.achievement,e.completednow)}))},this.progressComplete=function(t,n,r){e.achievementsProgressComplete(t,n,r,(function(e){return o(e.achievement,e.completednow)}))}},_pio.achievement=function(e,t,n,o,r,i,a){this.id=e,this.title=t,this.description=n,this.imageUrl=o,this.progress=void 0===r?0:r,this.progressGoal=i,this.lastUpdated=new Date(1e3*a),this.progressRatio=this.progress/this.progressGoal,this.completed=this.progress==this.progressGoal},_pio.playerInsight=function(e){this.playersOnline="[ERROR: You tried to access playerInsight.playersOnline before loading it. You have to call the refresh method first.]",this.segments={};var t=this;function n(e){-1==e.playersonline?t.playersOnline="[ERROR: The current connection does not have the rights required to read the playersonline variable.]":t.playersOnline=e.playersonline,t.segments=_pio.convertFromKVArray(e.segments)}this.refresh=function(t,o){e.playerInsightRefresh(t,o,(function(e){n(e.state)}))},this.setSegments=function(t,o,r){e.playerInsightSetSegments(_pio.convertToSegmentArray(t),o,r,(function(e){n(e.state)}))},this.trackInvitedBy=function(t,n,o,r){e.playerInsightTrackInvitedBy(t,n,o,r,(function(e){}))},this.trackEvent=function(t,n,o,r){e.playerInsightTrackEvents([{eventtype:t,value:n}],o,r,(function(e){}))},this.trackExternalPayment=function(t,n,o,r){e.playerInsightTrackExternalPayment(t,n,o,r,(function(e){}))},this.sessionKeepAlive=function(t,n){e.playerInsightSessionKeepAlive(t,n,(function(e){}))}},_pio.leaderboards=function(e,t){this.set=function(t,n,o,r,i){e.leaderboardsSet(t,n,o,r,i,(function(e){return new _pio.leaderboardEntry(e.leaderboardentry.userid,e.leaderboardentry.rank,e.leaderboardentry.score)}))},this.count=function(t,n,o,r){e.leaderboardsCount(t,n,o,r,(function(e){return e.count}))},this.getTop=function(t,n,o,r,i,a,s){e.leaderboardsGet(t,n,o,r,null,i,a,s,(function(e){if(null==e||null==e.leaderboardentry||0==e.leaderboardentry.length)return[];for(var t=[],n=0;n<e.leaderboardentry.length;n++)t.push(new _pio.leaderboardEntry(e.leaderboardentry[n].userid,e.leaderboardentry[n].rank,e.leaderboardentry[n].score));return t}))},this.getNeighbourhood=function(n,o,r,i,a,s,c){e.leaderboardsGet(n,o,r,i,t,a,s,c,(function(e){if(null==e||null==e.leaderboardentry||0==e.leaderboardentry.length)return[];for(var t=[],n=0;n<e.leaderboardentry.length;n++)t.push(new _pio.leaderboardEntry(e.leaderboardentry[n].userid,e.leaderboardentry[n].rank,e.leaderboardentry[n].score));return t}))}},_pio.leaderboardEntry=function(e,t,n){this.userId=e,this.rank=t,this.score=n},_pio.oneScore=function(e){this.percentile="[ERROR: You tried to access oneScore.percentile before loading the OneScore. You have to call the refresh method first.]",this.score="[ERROR: You tried to access oneScore.score before loading the OneScore. You have to call the refresh method first.]",this.topRank="[ERROR: You tried to access oneScore.topRank before loading the OneScore. You have to call the refresh method first.]";var t=this;this.refresh=function(n,o){e.oneScoreRefresh(n,o,(function(e){var n=new _pio.oneScoreValue(e.onescore.percentile,e.onescore.score,e.onescore.toprank);t.percentile=n.percentile,t.score=n.score,t.topRank=n.toprank}))},this.set=function(n,o,r){e.oneScoreSet(n,o,r,(function(e){var n=new _pio.oneScoreValue(e.onescore.percentile,e.onescore.score,e.onescore.toprank);return t.percentile=n.percentile,t.score=n.score,t.topRank=n.toprank,n}))},this.add=function(n,o,r){e.oneScoreAdd(n,o,r,(function(e){var n=new _pio.oneScoreValue(e.onescore.percentile,e.onescore.score,e.onescore.toprank);return t.percentile=n.percentile,t.score=n.score,t.topRank=n.toprank,n}))},this.load=function(t,n,o){if("object"==typeof t||requests.length)e.oneScoreLoad(t,n,o,(function(e){if(null==e||null==e.onescores||0==e.onescores.length)return[];for(var n=[],o=0,r=0;r<t.length;r++){var i=e.onescores[o];i&&t[r]==i.userid?(n.push(new _pio.oneScoreValue(i.percentile,i.score,i.toprank)),o++):n.push(null)}return n}));else{var r=_pio.error("The first argument to load should be an array: client.oneScore.load(['user1', 'user2', ...], ...)");_pio.handleError(r,o,r.code,r.message)}}},_pio.oneScoreValue=function(e,t,n){this.percentile=void 0===e?0:e,this.score=void 0===t?0:t,this.topRank=void 0===n?0:n},_pio.notifications=function(e){this.myEndpoints="[ERROR: You tried to access notifications.myEndpoints before calling refresh.]";var t=this,n="";function o(e){if(e.version!=n){var o=[];if(e.endpoints)for(var r=0;r!=e.endpoints.length;r++){var i=e.endpoints[r];o[r]=new _pio.notificationEndpoint(i.type,i.identifier,_pio.convertFromKVArray(i.configuration),!!i.enabled)}n=e.version,t.myEndpoints=o}}function r(e){var t=[];if(e&&e.length>0)for(var n=0;n!=e.length;n++){var o=e[n];o.type&&o.identifier&&t.push({type:o.type,identifier:o.identifier})}return t}this.refresh=function(t,r){e.notificationsRefresh(n,t,r,o)},this.registerEndpoint=function(r,i,a,s,c,l){var u,f,h=function(e,o){if(""!=n)for(var r=0;r!=t.myEndpoints.length;r++){var i=t.myEndpoints[r];if(i.type==e&&i.identifier==o)return i}return null}(r,i);null==h||h.enabled!=s||(u=h.configuration,f=a,JSON.stringify(u)!=JSON.stringify(f))?e.notificationsRegisterEndpoints(n,[{type:r,identifier:i,configuration:_pio.convertToKVArray(a),enabled:s}],c,l,o):c&&c()},this.toggleEndpoints=function(t,i,a,s){var c=r(t);c.length>0?e.notificationsToggleEndpoints(n,c,!!i,a,s,o):a&&a()},this.deleteEndpoints=function(t,i,a){var s=r(t);s.length>0?e.notificationsDeleteEndpoints(n,s,i,a,o):i&&i()},this.send=function(t,n,o){for(var r=[],i=0;i!=t.length;i++){var a=t[i],s={recipient:a.recipientUserId,endpointtype:a.endpointType,data:{}};for(var c in 0!=(s.recipient+"").length&&0!=(s.endpointtype+"").length||console.log("error"),a)"recipientUserId"!=c&&"endpointType"!=c&&(s.data[c]=a[c]);r[i]=s}r.length>0?e.notificationsSend(r,n,o,null):n&&n()}},_pio.notificationEndpoint=function(e,t,n,o){this.type=e,this.identifier=t,this.configuration=n,this.enabled=o},_pio.publishingNetwork=function(e,t){var n=this;this.profiles=new _pio.publishingNetworkProfiles(e),this.payments=new _pio.publishingNetworkPayments(e),this.relations=new _pio.publishingNetworkRelations(e,t,this),this.userToken="[ERROR: you tried to access publishingNetwork.userToken before calling publishingNetwork.refresh(callback)]",this.refresh=function(t,o){e.socialRefresh(t,o,(function(e){n.userToken=e.myprofile.usertoken,n.profiles.myProfile=new _pio.publishingNetworkProfile(e.myprofile),void 0===_pio.friendLookup&&(_pio.friendLookup={},_pio.blockedLookup={});var t=_pio.friendLookup[n.profiles.myProfile.userId],o=_pio.blockedLookup[n.profiles.myProfile.userId];t||o||(t=_pio.friendLookup[n.profiles.myProfile.userId]={},o=_pio.blockedLookup[n.profiles.myProfile.userId]={}),n.relations.friends=[];for(var r=0;r!=e.friends.length;r++){var i=new _pio.publishingNetworkProfile(e.friends[r]);n.relations.friends.push(i),t[i.userId]=!0}for(r=0;r!=e.blocked.length;r++)o[e.blocked[r]]=!0}))}},_pio.showDialog=function(e,t,n,o){if(void 0===window.PublishingNetwork)throw new PlayerIOError(PlayerIOErrorCode.PublishingNetworkNotAvailable,"PublishingNetwork.js was not found on the current page. You have to include the 'piocdn.com/publishingnetwork.js' on the containing page to show dialogs. See http://playerio.com/documentation/ for more information.");n.__apitoken__=t.token,window.PublishingNetwork.dialog(e,n,o)},_pio.publishingNetworkPayments=function(e){this.showBuyCoinsDialog=function(t,n,o,r){n||(n={}),n.coinamount=t,e.payVaultPaymentInfo("publishingnetwork",_pio.convertToKVArray(n),null,(function(t){_pio.showDialog("buy",e,t,(function(e){e.error?r(new PlayerIOError(PlayerIOErrorCode.GeneralError,e.error)):o(e)}))}),r,(function(e){return _pio.convertFromKVArray(e.providerarguments)}))},this.showBuyItemsDialog=function(t,n,o,r){e.payVaultPaymentInfo("publishingnetwork",_pio.convertToKVArray(n||{}),_pio.convertBuyItems(t),(function(t){_pio.showDialog("buy",e,t,(function(e){e.error?r(new PlayerIOError(PlayerIOErrorCode.GeneralError,e.error)):o(e)}))}),r,(function(e){return _pio.convertFromKVArray(e.providerarguments)}))}},_pio.publishingNetworkProfiles=function(e){this.myProfile="[ERROR: you tried to access publishingNetworkProfiles.myProfile before calling publishingNetwork.refresh(callback)]",this.showProfile=function(t,n){_pio.showDialog("profile",e,{userId:t},n)},this.loadProfiles=function(t,n,o){e.socialLoadProfiles(t,n,o,(function(e){for(var n=[],o=0;o!=t.length;o++){var r=t[o];n[o]=null;for(var i=0;i!=e.profiles.length;i++){var a=e.profiles[i];if(a&&a.userid==r){n[o]=new _pio.publishingNetworkProfile(e.profiles[i]);break}}}return n}))}},_pio.publishingNetworkProfile=function(e){this.userId=e.userid,this.displayName=e.displayname,this.avatarUrl=e.avatarurl,this.lastOnline=new Date(e.lastonline),this.countryCode=e.countrycode},_pio.publishingNetworkRelations=function(e,t,n){this.friends="[ERROR: you tried to access publishingNetworkRelations.friends before calling publishingNetwork.refresh(callback)]",this.isFriend=function(e){if(void 0!==_pio.friendLookup&&void 0!==_pio.friendLookup[t])return _pio.friendLookup[t][e]||!1;throw new PlayerIOError(PlayerIOErrorCode.PublishingNetworkNotLoaded,"Cannot access profile, friends, ignored before Publishing Network has been loaded. Please refresh Publishing Network first")},this.isBlocked=function(e){if(void 0!==_pio.blockedLookup&&void 0!==_pio.blockedLookup[t])return _pio.blockedLookup[t][e]||!1;throw new PlayerIOError(PlayerIOErrorCode.PublishingNetworkNotLoaded,"Cannot access profile, friends, ignored before Publishing Network has been loaded. Please refresh Publishing Network first")},this.showRequestFriendshipDialog=function(t,n){_pio.showDialog("requestfriendship",e,{userId:t},n)},this.showRequestBlockUserDialog=function(t,o){_pio.showDialog("requestblockuser",e,{userId:t},(function(){n.refresh((function(){o&&o()}),(function(){o&&o()}))}))},this.showFriendsManager=function(t){_pio.showDialog("friendsmanager",e,{},(function(e){e.updated?n.refresh((function(){t&&t()}),(function(){t&&t()})):t&&t()}))},this.showBlockedUsersManager=function(t){_pio.showDialog("blockedusersmanager",e,{},(function(e){e.updated?n.refresh((function(){t&&t()}),(function(){t&&t()})):t&&t()}))}}}}]);